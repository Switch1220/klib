generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions", "views"]
  binaryTargets   = ["native"]
}

datasource db {
  provider   = "postgresql"
  url        = env("POSTGRES_URL")
  extensions = [pg_trgm]
}

generator markdown {
  provider = "prisma-markdown"
  title    = "PROJECT"
  output   = "../docs/ERD.md"
}

model user {
  id String @id @db.Uuid

  username String @unique @db.VarChar
  password String @db.VarChar

  name String @db.VarChar

  created_at DateTime  @db.Timestamptz
  deleted_at DateTime? @db.Timestamptz

  //----
  // RELATIONS
  //----
  reservations seat_reservations[]
}

model seat {
  id String @id @db.Uuid

  info seat_info?

  //----
  // RELATIONS
  //----
  reservations seat_reservations[]
}

model seat_info {
  id String @id @db.Uuid

  seatId String @unique @db.Uuid

  //----
  // RELATIONS
  //----
  seat seat @relation(fields: [seatId], references: [id])
}

model seat_reservations {
  id String @id @db.Uuid

  seat_id String @unique @db.Uuid
  user_id String @unique @db.Uuid

  start_at DateTime @db.Timestamptz
  end_at   DateTime @db.Timestamptz

  canceled_at DateTime? @db.Timestamptz

  //----
  // RELATIONS
  //----
  target_seat seat @relation(fields: [seat_id], references: [id])
  target_user user @relation(fields: [user_id], references: [id])
}
